"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[914],{651:function(t,a,s){s.d(a,{j:function(){return e}});var c=s(3396),o=s(65);const e=t=>{const a=(0,o.oR)(),s=a.state.cartList,e=(t,s,c,o)=>{a.commit("changeCart",{shopId:t,productId:s,productInfo:c,num:o})},r=(0,c.Fl)((()=>{const a=s[t]?.productList||[],c={};for(const t in a){const s=a[t];s.count>0&&(c[t]=s)}return c})),n=(0,c.Fl)((()=>s[t]?.shopName||"")),_=(0,c.Fl)((()=>{const a={totalCount:0,totalPrice:0,allChecked:!0},c=s[t]?.productList;if(c)for(const t in c){const s=c[t];a.totalCount+=s.count,s.check&&(a.totalPrice+=s.count*s.price),!s.check&&s.count>0&&(a.allChecked=!1)}return a.totalPrice=a.totalPrice.toFixed(2),a}));return{cartList:s,changeCart:e,productList:r,shopName:n,calculations:_}}},6914:function(t,a,s){s.r(a),s.d(a,{default:function(){return E}});var c=s(3396),o=s(4870),e=s(2483);const r={class:"top"},n=(0,c.uE)('<div class="top__receiver" data-v-8d9b6382><div class="top__receiver__title" data-v-8d9b6382>收货地址</div><div class="top__receiver__address" data-v-8d9b6382>北京理工大学国防科技园2号楼10层</div><div class="top__receiver__info" data-v-8d9b6382><span class="top__receiver__info__name" data-v-8d9b6382>瑶妹（先生）</span><span class="top__receiver__info__name" data-v-8d9b6382>18911024266</span></div><div class="iconfont top__receiver__icon" data-v-8d9b6382></div></div>',1);var _={__name:"TopArea",setup(t){const a=(0,e.tv)();function s(){a.back()}return(t,a)=>((0,c.wg)(),(0,c.iD)("div",r,[(0,c._)("div",{class:"top__header"},[(0,c._)("div",{class:"iconfont top__header__back",onClick:s},"  "),(0,c.Uk)(" 确认订单 ")]),n]))}},i=s(89);const d=(0,i.Z)(_,[["__scopeId","data-v-8d9b6382"]]);var l=d,p=s(7139),u=s(651);const v={class:"products"},m={class:"products__title"},h={class:"products__wrapper"},w={class:"products__list"},f={key:0,class:"products__item"},k=["src"],C={class:"products__item__detail"},b={class:"products__item__title"},g={class:"products__item__price"},I={class:"products__item__yen"},D={class:"products__item__yen products__item__total"};var y={__name:"ProductList",setup(t){const a=(0,e.yj)(),s=a.params.id,{productList:r,shopName:n}=(0,u.j)(s);return(t,a)=>((0,c.wg)(),(0,c.iD)("div",v,[(0,c._)("div",m,(0,p.zw)((0,o.SU)(n)),1),(0,c._)("div",h,[(0,c._)("div",w,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)((0,o.SU)(r),(t=>((0,c.wg)(),(0,c.iD)(c.HY,{key:t._id},[t.count>0?((0,c.wg)(),(0,c.iD)("div",f,[(0,c._)("img",{class:"products__item__img",src:t.imgUrl},null,8,k),(0,c._)("div",C,[(0,c._)("span",b,(0,p.zw)(t.name),1),(0,c._)("div",g,[(0,c._)("span",I,"¥ "+(0,p.zw)(t.price)+" * "+(0,p.zw)(t.count),1),(0,c._)("span",D,"¥ "+(0,p.zw)((t.price*t.count).toFixed(2)),1)])])])):(0,c.kq)("",!0)],64)))),128))])])]))}};const L=(0,i.Z)(y,[["__scopeId","data-v-145acf22"]]);var O=L,j=(s(7658),s(65)),z=s(5088);const H=t=>((0,c.dD)("data-v-d5cd1132"),t=t(),(0,c.Cn)(),t),P={key:0,class:"modal__mask"},U=H((()=>(0,c._)("span",{class:"modal__wrapper__title"},"确认要离开收银台?",-1))),F=H((()=>(0,c._)("span",{class:"modal__wrapper__notice"},"请尽快完成支付，否则将被取消",-1)));var N={__name:"ConfirmModal",props:["show"],emits:["hide","confirmOrder","cancelOrder"],setup(t){return(a,s)=>t.show?((0,c.wg)(),(0,c.iD)("div",P,[(0,c._)("div",{class:"modal__wrapper",onClick:s[2]||(s[2]=t=>a.$emit("hide"))},[U,F,(0,c._)("button",{class:"modal__wrapper__cancel",onClick:s[0]||(s[0]=t=>a.$emit("cancelOrder"))},"取消订单"),(0,c._)("button",{class:"modal__wrapper__confirm",onClick:s[1]||(s[1]=t=>a.$emit("confirmOrder"))},"确认支付")])])):(0,c.kq)("",!0)}};const Z=(0,i.Z)(N,[["__scopeId","data-v-d5cd1132"]]);var S=Z;const W={class:"order"},M={class:"order__price"};var Y={__name:"ConfirmArea",emits:["showModal"],setup(t){const a=(0,e.tv)(),s=(0,e.yj)(),r=(0,j.oR)(),n=s.params.id,{shopName:_,productList:i,calculations:d}=(0,u.j)(n),l=(0,o.iH)(!1);async function v(t){const s=[];for(const a in i.value){const t=i.value[a];s.push({id:parseInt(t._id,10),num:t.count})}try{const c=await(0,z.v)("/api/order",{addressId:1,shopId:n,shopName:_.value,isCanceled:t,products:s});0===c?.errno&&(r.commit("clearCartData",{shopId:n}),a.push({name:"OrderList"}))}catch(c){console.log("下单失败")}}return(t,a)=>((0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",W,[(0,c._)("div",M,[(0,c.Uk)(" 实付金额 "),(0,c._)("b",null,"¥"+(0,p.zw)((0,o.SU)(d).totalPrice),1)]),(0,c._)("button",{class:"order__btn",onClick:a[0]||(a[0]=t=>l.value=!0)}," 提交订单 ")]),(0,c.Wm)(S,{show:l.value,onHide:a[1]||(a[1]=t=>l.value=!1),onConfirmOrder:a[2]||(a[2]=t=>v(!1)),onCancelOrder:a[3]||(a[3]=t=>v(!0))},null,8,["show"])],64))}};const $=(0,i.Z)(Y,[["__scopeId","data-v-e84398ac"]]);var q=$;const x={class:"wrapper"};var A={__name:"confirmOrder",setup(t){const a=(0,o.iH)(!1);return(t,s)=>((0,c.wg)(),(0,c.iD)("div",x,[(0,c.Wm)(l),(0,c.Wm)(O),(0,c.Wm)(q,{onShowModal:s[0]||(s[0]=t=>a.value=!a.value)})]))}};const R=(0,i.Z)(A,[["__scopeId","data-v-02392f2b"]]);var E=R}}]);
//# sourceMappingURL=914.e4bca5db.js.map