{"version":3,"file":"js/914.e4bca5db.js","mappings":"oKAGO,MAAMA,EAAWC,IACtB,MAAMC,GAAQC,EAAAA,EAAAA,MACRC,EAAWF,EAAMG,MAAMD,SACvBE,EAAaA,CAACL,EAAQM,EAAWC,EAAaC,KAClDP,EAAMQ,OAAO,aAAc,CACzBT,SAAQM,YAAWC,cAAaC,OAChC,EAEEE,GAAcC,EAAAA,EAAAA,KAAS,KAC3B,MAAMD,EAAcP,EAASH,IAASU,aAAe,GAC/CE,EAAY,CAAC,EACnB,IAAK,MAAMN,KAAaI,EAAa,CACnC,MAAMG,EAAUH,EAAYJ,GACxBO,EAAQC,MAAQ,IAClBF,EAAUN,GAAaO,EAE3B,CACA,OAAOD,CAAS,IAGZG,GAAWJ,EAAAA,EAAAA,KAAS,IAAMR,EAASH,IAASe,UAAY,KAExDC,GAAeL,EAAAA,EAAAA,KAAS,KAC5B,MAAMM,EAAS,CACbC,WAAY,EACZC,WAAY,EACZC,YAAY,GAERV,EAAcP,EAASH,IAASU,YACtC,GAAIA,EACF,IAAK,MAAMJ,KAAaI,EAAa,CACnC,MAAMG,EAAUH,EAAYJ,GAC5BW,EAAOC,YAAcL,EAAQC,MACzBD,EAAQQ,QACVJ,EAAOE,YAAcN,EAAQC,MAAQD,EAAQS,QAE1CT,EAAQQ,OAASR,EAAQC,MAAQ,IACpCG,EAAOG,YAAa,EAExB,CAGF,OADAH,EAAOE,WAAaF,EAAOE,WAAWI,QAAQ,GACvCN,CAAM,IAEf,MAAO,CAAEd,WAAUE,aAAYK,cAAaK,WAAUC,eAAc,C,6mBC5CtE,MAAMQ,GAASC,EAAAA,EAAAA,MACf,SAASC,IACPF,EAAOG,MACT,C,wLCAA,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,gZCJA,MAAMC,GAAQC,EAAAA,EAAAA,MACR9B,EAAS6B,EAAME,OAAOC,IACtB,YAAEtB,EAAW,SAAEK,IAAahB,EAAAA,EAAAA,GAAQC,G,0jBCA1C,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,kuBCFA,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,0GCCA,MAAMwB,GAASC,EAAAA,EAAAA,MACTI,GAAQC,EAAAA,EAAAA,MACR7B,GAAQC,EAAAA,EAAAA,MACRF,EAAS6B,EAAME,OAAOC,IACtB,SAAEjB,EAAQ,YAAEL,EAAW,aAAEM,IAAiBjB,EAAAA,EAAAA,GAAQC,GAClDiC,GAAcC,EAAAA,EAAAA,KAAI,GAExBC,eAAeC,EAAoBC,GACjC,MAAMC,EAAW,GACjB,IAAK,MAAMC,KAAK7B,EAAY8B,MAAO,CACjC,MAAM3B,EAAUH,EAAY8B,MAAMD,GAClCD,EAASG,KAAK,CACZT,GAAIU,SAAS7B,EAAQ8B,IAAK,IAC1BnC,IAAKK,EAAQC,OAEjB,CACA,IACE,MAAMG,QAAe2B,EAAAA,EAAAA,GAAK,aAAc,CACtCC,UAAW,EACX7C,SACAe,SAAUA,EAASyB,MACnBH,aACAC,aAEoB,IAAlBrB,GAAQ6B,QACV7C,EAAMQ,OAAO,gBAAiB,CAAET,WAChCwB,EAAOiB,KAAK,CAAEM,KAAM,cAExB,CAAE,MAAOC,GACPC,QAAQC,IAAI,OACd,CACF,C,gZClCA,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,Q,gECFA,MAAMjB,GAAcC,EAAAA,EAAAA,KAAI,G,mICAxB,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O","sources":["webpack://jingdong/./src/utils/useCart.js","webpack://jingdong/./src/components/TopArea.vue","webpack://jingdong/./src/components/TopArea.vue?9a2d","webpack://jingdong/./src/components/ProductList.vue","webpack://jingdong/./src/components/ProductList.vue?004b","webpack://jingdong/./src/components/ConfirmModal.vue","webpack://jingdong/./src/components/ConfirmArea.vue","webpack://jingdong/./src/components/ConfirmArea.vue?637c","webpack://jingdong/./src/views/confirmOrder.vue","webpack://jingdong/./src/views/confirmOrder.vue?a31f"],"sourcesContent":["import { computed } from 'vue'\r\nimport { useStore } from 'vuex'\r\n\r\nexport const useCart = (shopId) => {\r\n  const store = useStore()\r\n  const cartList = store.state.cartList\r\n  const changeCart = (shopId, productId, productInfo, num) => {\r\n    store.commit('changeCart', {\r\n      shopId, productId, productInfo, num\r\n    })\r\n  }\r\n  const productList = computed(() => {\r\n    const productList = cartList[shopId]?.productList || []\r\n    const finalList = {}\r\n    for (const productId in productList) {\r\n      const product = productList[productId]\r\n      if (product.count > 0) {\r\n        finalList[productId] = product\r\n      }\r\n    }\r\n    return finalList\r\n  })\r\n\r\n  const shopName = computed(() => cartList[shopId]?.shopName || '')\r\n\r\n  const calculations = computed(() => {\r\n    const result = {\r\n      totalCount: 0,\r\n      totalPrice: 0,\r\n      allChecked: true\r\n    }\r\n    const productList = cartList[shopId]?.productList\r\n    if (productList) {\r\n      for (const productId in productList) {\r\n        const product = productList[productId]\r\n        result.totalCount += product.count\r\n        if (product.check) {\r\n          result.totalPrice += product.count * product.price\r\n        }\r\n        if (!product.check && product.count > 0) {\r\n          result.allChecked = false\r\n        }\r\n      }\r\n    }\r\n    result.totalPrice = result.totalPrice.toFixed(2)\r\n    return result\r\n  })\r\n  return { cartList, changeCart, productList, shopName, calculations }\r\n}\r\n","<script setup>\r\nimport { useRouter } from 'vue-router'\r\n\r\nconst router = useRouter()\r\nfunction goBack () {\r\n  router.back()\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"top\">\r\n    <div class=\"top__header\">\r\n      <div\r\n        class=\"iconfont top__header__back\"\r\n        @click=\"goBack\"\r\n      >\r\n        &#xe697;\r\n      </div>\r\n        确认订单\r\n    </div>\r\n    <div class=\"top__receiver\">\r\n      <div class=\"top__receiver__title\">收货地址</div>\r\n      <div class=\"top__receiver__address\">北京理工大学国防科技园2号楼10层</div>\r\n      <div class=\"top__receiver__info\">\r\n        <span class=\"top__receiver__info__name\">瑶妹（先生）</span>\r\n        <span class=\"top__receiver__info__name\">18911024266</span>\r\n      </div>\r\n        <div class=\"iconfont top__receiver__icon\">&#xe697;</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../style/variables.scss';\r\n.top {\r\n  position: relative;\r\n  height: 1.96rem;\r\n  background-size: 100% 1.59rem;\r\n  background-image: linear-gradient(0deg, rgba(0,145,255,0.00) 4%, #0091FF 50%);\r\n  background-repeat: no-repeat;\r\n  &__header {\r\n    position: relative;\r\n    padding-top: .26rem;\r\n    line-height: .24rem;\r\n    color: $bgColor;\r\n    text-align: center;\r\n    font-size: .16rem;\r\n    &__back {\r\n      position: absolute;\r\n      left: .18rem;\r\n      font-size: .22rem;\r\n    }\r\n  }\r\n  &__receiver {\r\n    position: absolute;\r\n    left: .18rem;\r\n    right: .18rem;\r\n    bottom: 0;\r\n    height: 1.11rem;\r\n    background: $bgColor;\r\n    border-radius: .04rem;\r\n    &__title {\r\n      line-height: .22rem;\r\n      padding: .16rem 0 .14rem .16rem;\r\n      font-size: .16rem;\r\n      color: $content-fontcolor;\r\n    }\r\n    &__address {\r\n      line-height: .2rem;\r\n      padding: 0 .4rem 0 .16rem;\r\n      font-size: .14rem;\r\n      color: $content-fontcolor;\r\n    }\r\n    &__info {\r\n      padding: .06rem 0 0 .16rem;\r\n      &__name {\r\n        margin-right: .06rem;\r\n        line-height: .18rem;\r\n        font-size: .12rem;\r\n        color: $medium-fontColor;\r\n      }\r\n    }\r\n    &__icon {\r\n      transform: rotate(180deg);\r\n      position: absolute;\r\n      right: .16rem;\r\n      top: .5rem;\r\n      color: $medium-fontColor;\r\n      font-size: .2rem;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./TopArea.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./TopArea.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./TopArea.vue?vue&type=style&index=0&id=8d9b6382&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-8d9b6382\"]])\n\nexport default __exports__","<script setup>\r\nimport { useRoute } from 'vue-router'\r\nimport { useCart } from '../utils/useCart'\r\n\r\nconst route = useRoute()\r\nconst shopId = route.params.id\r\nconst { productList, shopName } = useCart(shopId) // change\r\n</script>\r\n\r\n<template>\r\n  <div class=\"products\">\r\n    <div class=\"products__title\">\r\n      {{ shopName }}\r\n    </div>\r\n    <div class=\"products__wrapper\">\r\n      <div class=\"products__list\">\r\n        <template\r\n          v-for=\"item in productList\"\r\n          :key=\"item._id\"\r\n        >\r\n          <div\r\n            class=\"products__item\"\r\n            v-if=\"item.count > 0\"\r\n          >\r\n            <img class=\"products__item__img\" :src=\"item.imgUrl\" />\r\n            <div class=\"products__item__detail\">\r\n              <span class=\"products__item__title\">{{ item.name }}</span>\r\n              <div class=\"products__item__price\">\r\n                <span class=\"products__item__yen\">&yen; {{ item.price }} * {{ item.count }}</span>\r\n                <span class=\"products__item__yen products__item__total\">&yen; {{ (item.price * item.count).toFixed(2) }}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </template>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../style/variables.scss';\r\n@import '../style/mixins.scss';\r\n.products {\r\n  margin: .16rem .18rem .1rem .18rem;\r\n  background: $bgColor;\r\n  &__title {\r\n    padding: .16rem;\r\n    font-size: .16rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__wrapper {\r\n    overflow-y: scroll;\r\n    margin: 0 .18rem;\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: .6rem;\r\n    top: 2.6rem;\r\n  }\r\n  &__list {\r\n    background: $bgColor;\r\n  }\r\n  &__item {\r\n    position: relative;\r\n    display: flex;\r\n    padding: 0 .16rem 0.16rem .16rem;\r\n    &__img {\r\n      width: .46rem;\r\n      height: .46rem;\r\n      margin-right: .16rem;\r\n    }\r\n    &__detail {\r\n      flex: 1;\r\n    }\r\n    &__title {\r\n      margin: 0;\r\n      line-height: .2rem;\r\n      font-size: .14rem;\r\n      color: $content-fontcolor;\r\n      @include ellipsis;\r\n    }\r\n    &__price {\r\n      display: flex;\r\n      margin: .06rem 0 0 0;\r\n      line-height: .2rem;\r\n      font-size: .14rem;\r\n      color: $hightlight-fontColor;\r\n    }\r\n    &__total {\r\n      flex: 1;\r\n      text-align: right;\r\n      color: $dark-fontColor;\r\n    }\r\n    &__yen {\r\n      font-size: .12rem;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./ProductList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ProductList.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ProductList.vue?vue&type=style&index=0&id=145acf22&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-145acf22\"]])\n\nexport default __exports__","import script from \"./ConfirmModal.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ConfirmModal.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ConfirmModal.vue?vue&type=style&index=0&id=d5cd1132&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-d5cd1132\"]])\n\nexport default __exports__","<script setup>\r\nimport { ref, defineEmits } from 'vue'\r\nimport { useRoute, useRouter } from 'vue-router'\r\nimport { useStore } from 'vuex'\r\nimport { useCart } from '../utils/useCart'\r\nimport { post } from '../utils/request'\r\nimport ConfirmModal from '../components/ConfirmModal.vue'\r\n\r\ndefineEmits(['showModal'])\r\nconst router = useRouter()\r\nconst route = useRoute()\r\nconst store = useStore()\r\nconst shopId = route.params.id\r\nconst { shopName, productList, calculations } = useCart(shopId) // change\r\nconst IfShowModal = ref(false)\r\n\r\nasync function handleConfirmOrder (isCanceled) {\r\n  const products = []\r\n  for (const i in productList.value) {\r\n    const product = productList.value[i]\r\n    products.push({\r\n      id: parseInt(product._id, 10),\r\n      num: product.count\r\n    })\r\n  }\r\n  try {\r\n    const result = await post('/api/order', {\r\n      addressId: 1,\r\n      shopId,\r\n      shopName: shopName.value,\r\n      isCanceled,\r\n      products\r\n    })\r\n    if (result?.errno === 0) {\r\n      store.commit('clearCartData', { shopId })\r\n      router.push({ name: 'OrderList' })\r\n    }\r\n  } catch (err) {\r\n    console.log('下单失败')\r\n  }\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div class=\"order\">\r\n    <div class=\"order__price\">\r\n      实付金额 <b>&yen;{{ calculations.totalPrice }}</b>\r\n    </div>\r\n    <button class=\"order__btn\" @click=\"IfShowModal = true\">\r\n      提交订单\r\n    </button>\r\n  </div>\r\n  <ConfirmModal\r\n    :show=\"IfShowModal\"\r\n    @hide=\"IfShowModal=false\"\r\n    @confirmOrder=\"handleConfirmOrder(false)\"\r\n    @cancelOrder=\"handleConfirmOrder(true)\"\r\n  />\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../style/variables.scss';\r\n@import '../style/mixins.scss';\r\n.order {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  display: flex;\r\n  height: .49rem;\r\n  line-height: .49rem;\r\n  background: $bgColor;\r\n  &__price {\r\n    flex: 1;\r\n    text-indent: .24rem;\r\n    font-size: .14rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__btn {\r\n    width: .98rem;\r\n    border: none;\r\n    background: #4FB0F9;\r\n    color: $bgColor;\r\n    text-align: center;\r\n    font-size: .14rem;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./ConfirmArea.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./ConfirmArea.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./ConfirmArea.vue?vue&type=style&index=0&id=e84398ac&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-e84398ac\"]])\n\nexport default __exports__","<script setup>\r\nimport { ref } from 'vue'\r\nimport TopArea from '../components/TopArea.vue'\r\nimport ProductList from '../components/ProductList.vue'\r\nimport ConfirmArea from '../components/ConfirmArea.vue'\r\n\r\nconst IfShowModal = ref(false)\r\n\r\n</script>\r\n\r\n<template>\r\n  <div class=\"wrapper\">\r\n    <TopArea />\r\n    <ProductList />\r\n    <ConfirmArea @showModal=\"IfShowModal = !IfShowModal\"/>\r\n  </div>\r\n</template>\r\n\r\n<style lang=\"scss\" scoped>\r\n.wrapper {\r\n  position: absolute;\r\n  left: 0;\r\n  right: 0;\r\n  top: 0;\r\n  bottom: 0;\r\n  background-color: #eee;\r\n  overflow-y: scroll;\r\n}\r\n</style>\r\n","import script from \"./confirmOrder.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./confirmOrder.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./confirmOrder.vue?vue&type=style&index=0&id=02392f2b&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-02392f2b\"]])\n\nexport default __exports__"],"names":["useCart","shopId","store","useStore","cartList","state","changeCart","productId","productInfo","num","commit","productList","computed","finalList","product","count","shopName","calculations","result","totalCount","totalPrice","allChecked","check","price","toFixed","router","useRouter","goBack","back","__exports__","route","useRoute","params","id","IfShowModal","ref","async","handleConfirmOrder","isCanceled","products","i","value","push","parseInt","_id","post","addressId","errno","name","err","console","log"],"sourceRoot":""}